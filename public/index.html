<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Portal Escolar - Login</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap');
    * { margin:0; padding:0; box-sizing:border-box; font-family:'Orbitron', sans-serif; }
    body {
      background: radial-gradient(circle at top left, #4b0082, #000);
      display: flex; justify-content:center; align-items:center;
      height:100vh; color:#fff;
    }
    #loginPage {
      background: rgba(75,0,130,0.8);
      padding: 2rem; border-radius: 1rem;
      box-shadow: 0 0 25px #ba55d3;
      width: 90%; max-width: 400px;
      display: flex; flex-direction: column; gap: 1rem;
      backdrop-filter: blur(6px);
    }
    #loginPage h2 {
      text-align:center;
      color:#e0b3ff;
      text-shadow: 0 0 10px #ba55d3;
      font-weight: 700;
    }
    input {
      padding: 0.9rem;
      border:none;
      border-radius:0.5rem;
      outline:none;
      font-size: 1rem;
      background-color: #1c0033;
      color:#fff;
      box-shadow: inset 0 0 5px #7a00cc;
    }
    input::placeholder {
      color:#999;
    }
    button {
      padding: 0.9rem;
      background: linear-gradient(45deg, #8e2de2, #4a00e0);
      border:none;
      border-radius: 0.5rem;
      color:#fff;
      font-size: 1.1rem;
      cursor:pointer;
      box-shadow: 0 0 10px #c964ff;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    button:hover {
      transform: scale(1.05);
      box-shadow: 0 0 15px #d87aff;
    }
    #toggleSwitch {
      display:flex; align-items:center; gap:0.5rem;
      color:#cbb0ff;
      cursor:pointer;
      user-select:none;
      font-size: 0.9rem;
      margin-top: -0.5rem;
    }
    #toggleSwitch input {
      cursor:pointer;
    }
  </style>
</head>
<body>
  <div id="loginPage">
    <h2>Portal Escolar</h2>
    <input type="text" id="fullName" placeholder="Nome completo" />
    <input type="text" id="serie" placeholder="Série (Ex: 1ºD)" />
    <input type="password" id="password" placeholder="Senha" />
    <div id="toggleSwitch">
      <input type="checkbox" id="modeToggle" />
      <label for="modeToggle">Cadastrar novo usuário</label>
    </div>
    <button id="actionBtn" onclick="handleAction()">Entrar</button>
  </div>

  <script>
    function getUsername() {
      const name = document.getElementById("fullName").value.trim();
      const serie = document.getElementById("serie").value.trim();
      return `${name} (${serie})`;
    }

    function handleAction() {
      const isRegister = document.getElementById("modeToggle").checked;
      const username = getUsername();
      const password = document.getElementById("password").value.trim();

      if (!username || !password) {
        alert("Preencha todos os campos!");
        return;
      }

      let users = JSON.parse(localStorage.getItem("users") || "{}");

      if (isRegister) {
        // Cadastrar
        if (users[username]) {
          alert("Usuário já existe!");
          return;
        }
        users[username] = { password: password, points: 0 };
        localStorage.setItem("users", JSON.stringify(users));
        alert("Cadastro realizado com sucesso! Agora faça login.");
        document.getElementById("modeToggle").checked = false;
        document.getElementById("actionBtn").innerText = "Entrar";
      } else {
        // Login
        if (!users[username]) {
          alert("Usuário não encontrado!");
          return;
        }
        if (users[username].password !== password) {
          alert("Senha incorreta!");
          return;
        }
        localStorage.setItem("currentUser", username);
        alert(`Bem-vindo, ${username}!`);
        window.location.href = "painel.html";
      }
    }

    // Atualiza botão conforme toggle
    document.getElementById("modeToggle").addEventListener("change", function(){
      document.getElementById("actionBtn").innerText = this.checked ? "Cadastrar" : "Entrar";
    });
  </script>
</body>
</html>
